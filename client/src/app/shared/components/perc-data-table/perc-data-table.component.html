<div class="bg-white rounded-lg overflow-hidden shadow-sm">
  <div class="overflow-x-auto">
    <table mat-table [dataSource]="dataSource" matSort class="w-full">
      <!-- Dynamic Columns -->
      <ng-container *ngFor="let column of columns" [matColumnDef]="column.key">
        <th 
          mat-header-cell 
          *matHeaderCellDef 
          [mat-sort-header]="isColumnSortable(column) ? column.key : ''"
          [ngClass]="{
            '!bg-indigo-600 !text-white font-semibold text-sm uppercase tracking-wide px-6 py-4': true,
            'w-[100px] min-w-[100px] max-w-[100px]': column.key === 'id',
            'w-[400px] min-w-[400px] max-w-[400px]': column.key === 'name'
          }"
        >
          {{ column.label }}
        </th>
        <td 
          mat-cell 
          *matCellDef="let item" 
          [ngClass]="{
            'px-6 py-4 text-sm text-slate-700 border-b border-slate-200': true,
            'w-[100px] min-w-[100px] max-w-[100px]': column.key === 'id',
            'w-[400px] min-w-[400px] max-w-[400px]': column.key === 'name'
          }"
        >
          {{ getCellValue(item, column) }}
        </td>
      </ng-container>

      <!-- Actions Column -->
      <ng-container *ngIf="configMerged.showEditButton || configMerged.showDeleteButton" matColumnDef="actions">
        <th mat-header-cell *matHeaderCellDef class="!bg-indigo-600 !text-white font-semibold text-sm uppercase tracking-wide px-6 py-4 text-left w-[280px] min-w-[280px] max-w-[280px]">
          Actions
        </th>
        <td mat-cell *matCellDef="let item" class="px-6 py-4 text-sm text-slate-700 border-b border-slate-200 text-left w-[280px] min-w-[280px] max-w-[280px]">
          <div class="flex gap-2 justify-start items-center">
            <perc-button
              *ngIf="configMerged.showEditButton"
              [label]="configMerged.editButtonLabel"
              icon="edit"
              color="primary"
              [disabled]="isLoading"
              (clicked)="onEditClick(item)"
              class="min-w-0 px-4 py-2 text-sm transition-all duration-200  hover:-translate-y-0.5"
            ></perc-button>

            <perc-button
              *ngIf="configMerged.showDeleteButton"
              [label]="configMerged.deleteButtonLabel"
              icon="delete"
              color="warn"
              [disabled]="isLoading"
              (clicked)="onDeleteClick(item)"
              class="min-w-0 px-4 py-2 text-sm transition-all duration-200 hover:-translate-y-0.5"
            ></perc-button>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns" class="!bg-indigo-600"></tr>
      <tr 
        mat-row 
        *matRowDef="let row; columns: displayedColumns" 
        [ngClass]="{
          'bg-gradient-to-r from-indigo-50 to-purple-50 border-l-4 border-indigo-500 font-medium': isRowSelected(row)
        }"
        class="cursor-pointer hover:bg-slate-50"
      ></tr>
    </table>
  </div>

  <mat-paginator
    *ngIf="dataSource.data.length > 0"
    [pageSizeOptions]="configMerged.pageSizeOptions ?? []"
    [pageSize]="configMerged.pageSize ?? 10"
    showFirstLastButtons
    class="border-t border-slate-200 bg-white"
  ></mat-paginator>

  <div *ngIf="isEmpty" class="py-12 px-4 text-center bg-white">
    <p class="text-slate-500 text-sm">{{ emptyMessage }}</p>
  </div>
</div>
